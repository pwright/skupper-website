version: 1

defaults:
  recursive: true
  parallelism: 4
  timeout_sec: 30

scripts:
  cat_file:
    cmd: "cat"
    args: []
    stdin: "file"
    expects: "file"

targets:
  - name: "cat-build"
    type: "directory"
    path: "./build"
    recursive: true
    filter:
      include_globs: ["*","**/*"]   # include top-level files AND recursive
      exclude_globs: ["**/.git/**"]
    execution:
      mode: "per-file"
      order: "stable"
    scripts:
      - use: "cat_file"

output:
  format: "ndjson"
  include_fields: ["target", "file", "stdout", "exit_code"]
